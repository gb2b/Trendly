<!doctype html>
<html lang="en">
<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <title>Trendly : Les tendances de demain</title>
        <meta name="description" content="">

        <meta name="viewport" content="width=device-width,initial-scale=1">
       <!-- <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'> -->
 		<!--<link href='http://fonts.googleapis.com/css?family=Fredoka+One' rel='stylesheet' type='text/css'>-->
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/trendly.css">


        
</head>
<body style="transition : all 2s linear">
	<h1><span>trend.</span>ly</h1>
  	<section>
		<section id="test" style="width: 500px;margin:0px auto;">
  		</section>

		<form id="search">
			<input type="text" placeholder="Search a trend" name="text-search" id="text-search"/>
			<input type="submit" value="A" id="submit" name="submit"/>
		</form>
  	</section>
	<div id="searchtest" style="border: 3px solid black;background:red;display:none"> Test </div>
  	
  	

    <script src="http://d3js.org/d3.v3.min.js"></script>
  	<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script>
var searchText = $("#searchtest");
var formu = document.forms['search'];
var element = formu.elements['text-search'];

var circleTest = $("#test");
var randTime = (Math.random()*20) + 10;

     

var opaque = [0.5,0.7,0.9];

var width = 500,
    height = 500,
    radius = Math.min(width, height) / 2;

var color = d3.scale.ordinal()
    .range(["#98abc5", "#8a89a6", "#7b6888", "#61E74E", "#a05d56", "#d0743c", "#ff8c00","#64020A"]);

var arc = d3.svg.arc()
    .outerRadius(radius - 50)
    .innerRadius(radius - 70);

var pie = d3.layout.pie()
    .sort(null)
    .value(function(d) { return d.population; });

var svg = d3.select("#test").append("svg")
    .attr("width", width)
    .attr("height", height)
  	.append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");
    

d3.csv("data.csv", function(error, data) {
  var rand;
  
  data.forEach(function(d) {
    d.population = 500;
     rand = Math.floor(Math.random()*10);
	  console.log(rand);
	  if(rand > -1 && rand < 4) rand = 0; 
	  else if(rand > 3 && rand < 7) rand = 1;
	  else if(rand > 6 && rand < 10) rand = 2;
	  else rand = 0;
	  console.log(rand);
	  console.log(opaque[rand]);
    radius = radius/3;

  });

  var g = svg.selectAll(".arc")
      .data(pie(data))
    .enter().append("g")
      .attr("class", "arc");

  

  g.append("path")
      .attr("d", arc)
      .style("opacity", opaque[rand])
      .style("transition","all .3s linear")
      .on("load",function(d){
          circleTest.style = ("animation", "rotation 2s linear 0.4s infinite");
          circleTest.style = ("-webkit-animation","rotation " + randTime +"s linear 0.4s infinite");
      })
      .style("fill", function(d) { return color(d.data.age); })
      	.on("mouseover", function(d){
      		d3.select(this).style("opacity", 1);
      		d3.select(this).style("cursor", "pointer");
      		test = function(d) { return d.data.age;};
      		element.value = test(d);
     	 })
    	.on("mouseout", function(d){
    		d3.select(this).style("opacity", opaque[rand]);
      		d3.select(this).style("cursor", "default");
   	 		element.value = "";
   	 	});


 
});

</script>
</body>
</html>